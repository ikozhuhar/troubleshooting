# Troubleshooting

## Диски

du  
df  
smartctl  
lsblk  
blkid  
/proc/mdstat  

## Процессор и память

iostat  
iotop  
top  
atop  
vmstat  
free  
/proc/meminfo  

## Процессы  

ps -efl | -aux  
strace  
systemctl status nginx  
kill -9 pid  

## Сеть  

netstat | ss  
ip a | ifconfig  
netstat -rm | route | ip r  
ping  
traceroute  
mtr  
dig  
nslookup  
curl  
curl telnet  
tcpdump  

## Логи  

journalctl  
/var/log/dmesg  
/var/log  
/var/log/syslog   


## Программа fsck — проверка файловых систем

Программа fsck используется для проверки файловых систем и для коррекции ошибок файловой системы, если таковые найдутся. Основное требование для проверки файловой системы: файловая система должна быть размонтирована. Запуск fsck для уже смонтированной файловой системы может привести к ее разрушению — тогда уже даже и fsck не поможет. Программа fsck может использоваться для проверки файловых систем, которые поддерживаются ядром Linux.

Приведем пошаговые инструкции по восстановлению файловой системы.

1. Переходим в однопользовательский режим. Для этого входим с правами суперпользователя и набираем команду:
```
init 1 
```

2. Следующим шагом демонтируем файловую систему, которую мы будем проверять. Пусть это будет /mnt/sdb1 (файловая система, которая в нашем примере соответствует первичному диску на втором SCSI-диске). Для этого вводим команду:
```
umount /mnt/sdb1
```

В случае, если речь идет о корневой файловой системе, то демонтировать ее невозможно, поэтому перемонтируем ее в режиме только для чтения:
```
mount —n —o remount,ro /
```

3. Запускаем проверку файловой системы:
```
fsck —f /dev/sdb1 
```

4. Проверенные и исправленные файловые системы необходимо смонтировать снова:
```
mount /mnt/sdb1 
```

Или для корневой файловой системы:
```
mount —n —o remount, rw / 
```

5. Возвращаемся к исходному уровню работы, если это был графический режим, то:
```
init 5
```

Если по умолчанию вы запускаетесь в текстовом режиме, то это будет команда:
```
init 3 
```
